# 수도권 생활이동 데이터 해커톤 (예선·결선 포함)

## 주제: 베드타운을 핫플레이스로!

## 요약(Summary)
  1. 베드타운(bed town) 및 핫플레이스(hot place)의 인구 이동 양상과 특징을 비교 분석
  2. Tableau를 활용한 베드타운/핫플레이스 핵심 지표 시각화 모델 개발
  3. 슈퍼컴퓨터를 활용한 빅데이터(원본 통합데이터 규모 정보: parquet 기준 80GB, 약 20억개 행) 분석 및 인사이트 추출
     

---

## 내가 맡은 역할 (Role)
- **데이터 통합**: Parquet 다중 파일을 **Polars Lazy 스캔**으로 통합하여 처리 성능과 메모리를 최적화했습니다.  
- **정합·전처리**
  - **행정동(ADMDONG) 코드 정합**을 수행하여 폐지·변경 이력을 반영하고 출발/도착 양측 코드를 일치시켰습니다.
  - **이동 목적 코드 매핑**을 정리하여 표준화 컬럼으로 적용했습니다.
  - **시간대 코드 표준화**를 위해 `st_time_cd` 정수화 및 날짜(`etl_ymd`) 파싱을 완료했습니다.
  - **좌표계 정리**: 중부원점 TM(예: EPSG:5179) → Web Mercator(3857) → WGS84(4326) 변환 로직을 정리하고 샘플 검증을 수행했습니다.
  
- **지표 설계·산출**
  - **베드타운 지표**: 주말·야간 체류/유출 패턴을 결합해 거주지 성격을 수치화했습니다.
  - **핫플레이스 지표**: **당일** 유입+유출 동시 활성에 집중해 출퇴근성 왕복 노이즈를 배제했습니다.
  - **연령대 집계**: 0–10, 20–30, 40–50, 60+ 구성 비중 및 월평균/추세를 산출했습니다.
  - **랭킹·흐름 분석**: 동/구 레벨 랭킹 및 Top-N 목적지 흐름을 도출했습니다.
- **결선 산출물 정리**: 지표 정의 → 사례 지역 해석 → 활용 제안으로 구성된 **스토리라인**과 결과 테이블을 패키징했습니다.
- **품질 관리**: 좌표 변환 샘플 검점, 코드/매핑 일관성 검사, 누락·이상치 점검 로깅을 수행했습니다.

---

## 데이터 사양(핵심 컬럼)
| 구분 | 컬럼 | 설명 |
|---|---|---|
| 식별/영역 | `o_admdong_cd`, `d_admdong_cd` | 출발/도착 행정동 코드 |
| 시간 | `etl_ymd`, `st_time_cd`, `fns_time_cd` | 추출 일자(YYYYMMDD), 시작/종료 시간 코드 |
| 이동 특성 | `move_dist`, `move_time`, `purpose_code` | 이동거리/시간, 이동 목적(매핑 적용 대상) |
| 인구 집계 | `0010_cnt`, `2030_cnt`, `4050_cnt`, `60plus_cnt`, `total_cnt` | 연령대·전체 카운트 |

> 목적 코드는 **내부 매핑 테이블**을 통해 표준화하여 해석 일관성을 확보했습니다.

---

## 분석 기준(필터)
- **기간**: 2024년 중심(필요 시 월/분기 서브셋)  
- **요일**: 주말 중심(핫플·베드타운 구분 목적)  
- **시간대**: `st_time_cd` 기반 야간/주간 구간 정의  
- **목적**: 출근·등교·쇼핑·관광·병원·귀가·기타 중 분석 축에 해당하는 항목 선택

---

## 파이프라인 요약
1. **로드·서브셋**: Parquet 다중 파일을 Lazy로 스캔하고 필요한 컬럼만 선택합니다.  
2. **표준화**: 날짜 파싱, `st_time_cd` 정수화, 목적 코드 **매핑 적용**을 수행합니다.  
3. **정합**: 행정동 **폐지/변경 이력**을 반영해 출발/도착 코드 정합을 맞춥니다.  
4. **좌표 변환**: 5179 → 3857 → 4326 변환을 출발/도착 각각에 적용하고 샘플 검증합니다.  
5. **필터링**: 연도/요일(주말)/시간대/목적 필터를 조합해 분석 대상을 확정합니다.  
6. **집계·지표**: 동·구·연령대 수준 집계 후 **베드타운/핫플레이스 지표**를 계산합니다.  
7. **랭킹·흐름**: 상·하위 랭킹과 **Top-N 목적지 흐름**을 도출합니다.  

---

## 지표 정의(요약)
### 베드타운 지표
- **핵심 아이디어**: “밤에는 머물고 낮에는 빠져나가는” 패턴을 수치화합니다.  
- **사용 신호**: 주말 야간 체류 비중, 당일 유출/유입 비중, 이동거리·시간(보조 신호) 등을 결합합니다.

### 핫플레이스 지표
- **핵심 아이디어**: 동일 일자 내 **유입+유출 동시 활성**을 강조합니다.  
- **노이즈 배제**: 출퇴근성 왕복(예: 금→월) 패턴을 노이즈로 간주해 배제합니다.

> 상세 수식/가중치 및 조정 이력은 별도 지표 문서에 정리했습니다(본선 기간 중 튜닝 내역 포함).

---

## 대표 산출물(실제 파일)
- `남향동_출발_전체.parquet` : 출발 기준 동(洞) 단위 Top-N 흐름 및 연령대 구성 결과를 정리했습니다.  
- `잠실4동_도착_전체.parquet` : 도착 기준 동 단위 Top-N 흐름 및 연령대 구성 결과를 정리했습니다.  
- `merged_all_admi.parquet` : ADMDONG 부착 및 통합본입니다.  
- `merged_all_admi_opt.parquet` : 용량·컬럼 최적화본입니다.

---

## 작업 로그 하이라이트
- **목적 코드 매핑**: 미정의 코드 탐지 시 경고 로깅이 발생하도록 점검 체계를 구성했습니다.  
- **행정동 변경 이력 반영**: 폐지·통합·이관 케이스를 정리하여 양측 코드 일치화를 완료했습니다.  
- **시간대 코드 표준화**: `st_time_cd`를 정수화하고 날짜 파싱을 일괄 적용했습니다.  
- **주말 필터**: `weekday in [5,6]` 조건을 적용한 분석 라인을 확립했습니다.  
- **월평균·연령대 집계**: 동별 월평균 및 연령대 구성, **Top-N 목적지 기준 분석**을 수행했습니다.  
- **중간 산출물 관리**: 스트리밍 처리 중 `.tmp` 용량 체크 및 로그 기록을 수행했습니다.

---

## 본선·결선 타임라인 요약
- **본선(2025-08-04 ~ 2025-08-26)**: 통합·정합·전처리 파이프라인 정리, 지표 정의 및 초기 산출, 동별 포커스 분석을 완료했습니다.  
- **결선 준비**: 지표 해석 스토리라인 고도화, 사례 지역 비교, 결과 테이블 패키징을 진행했습니다.

---

## 다음 단계(To-Do)
- 지표 가중치 **민감도 분석** 및 신뢰 구간 보조지표 제시가 필요합니다.  
- 외부 **인프라/일자리 지표**를 결합하여 설명력을 강화하겠습니다.  
- 동별 사례 **내러티브**를 보강하고, 표준 리포트 템플릿을 정리하겠습니다.

---

## 사용 기술
- **Python**, **Polars**, **Pandas**, **PyProj**  
- 파일 포맷: **Parquet**
